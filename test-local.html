<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Workout Tracking Form - Local Test</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Coach.Khaled.Safwat</h1>
            <p>Log your daily workouts (Local Test Version)</p>
            <p style="background: #fff3cd; padding: 10px; border-radius: 5px; margin-top: 10px; color: #000;">
                ‚ö†Ô∏è Local Test Mode - Data will be displayed in Console (Press F12)
            </p>
        </header>

        <form id="workoutForm" enctype="multipart/form-data">
            <div class="form-section">
                <h2>Personal Information</h2>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="name">Name</label>
                        <input type="text" id="name" name="name" required>
                    </div>

                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="weight">Weight (kg)</label>
                        <input type="number" id="weight" name="weight" step="0.1" min="0" required>
                    </div>

                    <div class="form-group">
                        <label for="date">Date</label>
                        <input type="date" id="date" name="date" required>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h2>Exercises</h2>

                <div class="exercises-row">
                    <div class="exercise-group">
                        <h3>1. Incline DB Press (ÿØÿßŸÖÿ®ŸÑ ÿπÿßŸÑŸä ŸÑŸÑÿµÿØÿ±)</h3>
                        <div class="form-group">
                            <label for="exercise1_sets">Number of Working Sets</label>
                            <input type="number" id="exercise1_sets" name="exercise1_sets" min="1" required>
                        </div>
                        <div id="exercise1_sets_container" class="sets-container"></div>
                    </div>

                    <div class="exercise-group">
                        <h3>2. Tricep Pushdown (ÿ™ÿ±ÿßŸä ÿ®Ÿàÿ¥ ÿØÿßŸàŸÜ)</h3>
                        <div class="form-group">
                            <label for="exercise2_sets">Number of Working Sets</label>
                            <input type="number" id="exercise2_sets" name="exercise2_sets" min="1" required>
                        </div>
                        <div id="exercise2_sets_container" class="sets-container"></div>
                    </div>
                </div>

                <div class="exercises-row">
                    <div class="exercise-group">
                        <h3>3. Wide Lat Pull Down (ÿ≥ÿ≠ÿ® ÿπÿßŸÑŸä Ÿàÿßÿ≥ÿπ)</h3>
                        <div class="form-group">
                            <label for="exercise3_sets">Number of Working Sets</label>
                            <input type="number" id="exercise3_sets" name="exercise3_sets" min="1" required>
                        </div>
                        <div id="exercise3_sets_container" class="sets-container"></div>
                    </div>

                    <div class="exercise-group">
                        <h3>4. T-Bar Row (ÿ≥ÿ≠ÿ® ÿπÿßŸÑÿ™Ÿä ÿ®ÿßÿ±)</h3>
                        <div class="form-group">
                            <label for="exercise4_sets">Number of Working Sets</label>
                            <input type="number" id="exercise4_sets" name="exercise4_sets" min="1" required>
                        </div>
                        <div id="exercise4_sets_container" class="sets-container"></div>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h2>Attachments (Optional)</h2>
                <div class="file-upload-wrapper">
                    <div class="file-upload-area" id="fileUploadArea">
                        <input type="file" id="attachment" name="attachment" accept="image/*,.pdf,.doc,.docx" hidden>
                        <div class="file-upload-content">
                            <svg class="upload-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                            <p class="upload-text">Click to upload or drag and drop</p>
                            <p class="upload-hint">PNG, JPG, PDF, DOC, DOCX (Max 10MB)</p>
                        </div>
                        <div class="file-upload-preview" id="filePreview" style="display: none;">
                            <div class="preview-content">
                                <img id="previewImage" src="" alt="Preview" style="display: none;">
                                <div class="file-info">
                                    <span class="file-name" id="fileName"></span>
                                    <span class="file-size" id="fileSize"></span>
                                </div>
                                <button type="button" class="remove-file" id="removeFile">√ó</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" id="submitBtn">Submit (Test Mode)</button>
            </div>

            <div id="message" class="message"></div>
        </form>
    </div>

    <script>
        // Set today's date as default
        document.getElementById('date').valueAsDate = new Date();

        // Function to create set fields dynamically
        function createSetFields(exerciseNum, numSets) {
            const container = document.getElementById(`exercise${exerciseNum}_sets_container`);
            container.innerHTML = '';
            
            if (numSets > 0) {
                for (let i = 1; i <= numSets; i++) {
                    const setGroup = document.createElement('div');
                    setGroup.className = 'set-group';
                    setGroup.innerHTML = `
                        <div class="set-header">Set ${i}</div>
                        <div class="set-fields">
                            <div class="form-group">
                                <label for="exercise${exerciseNum}_set${i}_reps">Reps</label>
                                <input type="number" id="exercise${exerciseNum}_set${i}_reps" name="exercise${exerciseNum}_set${i}_reps" min="1" required>
                            </div>
                            <div class="form-group">
                                <label for="exercise${exerciseNum}_set${i}_weight">Weight (kg)</label>
                                <input type="number" id="exercise${exerciseNum}_set${i}_weight" name="exercise${exerciseNum}_set${i}_weight" step="0.1" min="0" required>
                            </div>
                        </div>
                    `;
                    container.appendChild(setGroup);
                }
            }
        }

        // Add event listeners for sets input changes
        for (let i = 1; i <= 4; i++) {
            const setsInput = document.getElementById(`exercise${i}_sets`);
            setsInput.addEventListener('input', function() {
                const numSets = parseInt(this.value) || 0;
                createSetFields(i, numSets);
            });
        }

        // File Upload Functionality
        const fileInput = document.getElementById('attachment');
        const fileUploadArea = document.getElementById('fileUploadArea');
        const filePreview = document.getElementById('filePreview');
        const previewImage = document.getElementById('previewImage');
        const fileName = document.getElementById('fileName');
        const fileSize = document.getElementById('fileSize');
        const removeFileBtn = document.getElementById('removeFile');
        const fileUploadContent = document.querySelector('.file-upload-content');

        // Format file size
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }

        // Handle file selection
        fileInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                handleFile(file);
            }
        });

        // Handle file
        function handleFile(file) {
            // Check file size (10MB limit)
            const maxSize = 10 * 1024 * 1024; // 10MB
            if (file.size > maxSize) {
                alert('File size exceeds 10MB limit. Please choose a smaller file.');
                fileInput.value = '';
                return;
            }

            // Show preview
            fileUploadContent.style.display = 'none';
            filePreview.style.display = 'block';
            
            // Set file name and size
            fileName.textContent = file.name;
            fileSize.textContent = formatFileSize(file.size);

            // If it's an image, show preview
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImage.src = e.target.result;
                    previewImage.style.display = 'block';
                };
                reader.readAsDataURL(file);
            } else {
                previewImage.style.display = 'none';
            }
        }

        // Remove file
        removeFileBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            fileInput.value = '';
            fileUploadContent.style.display = 'flex';
            filePreview.style.display = 'none';
            previewImage.src = '';
            previewImage.style.display = 'none';
        });

        // Drag and drop functionality
        fileUploadArea.addEventListener('dragover', function(e) {
            e.preventDefault();
            e.stopPropagation();
            fileUploadArea.classList.add('dragover');
        });

        fileUploadArea.addEventListener('dragleave', function(e) {
            e.preventDefault();
            e.stopPropagation();
            fileUploadArea.classList.remove('dragover');
        });

        fileUploadArea.addEventListener('drop', function(e) {
            e.preventDefault();
            e.stopPropagation();
            fileUploadArea.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                // Create a new FileList-like object
                const dataTransfer = new DataTransfer();
                dataTransfer.items.add(files[0]);
                fileInput.files = dataTransfer.files;
                handleFile(files[0]);
            }
        });

        // Click to upload
        fileUploadArea.addEventListener('click', function(e) {
            if (e.target !== removeFileBtn && !filePreview.contains(e.target)) {
                fileInput.click();
            }
        });

        // Form submission (local test mode)
        document.getElementById('workoutForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const messageDiv = document.getElementById('message');
            
            // Disable submit button
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            
            // Clear previous messages
            messageDiv.className = 'message';
            messageDiv.textContent = '';
            
            try {
                // Collect form data
                const formData = {
                    name: document.getElementById('name').value,
                    email: document.getElementById('email').value,
                    weight: document.getElementById('weight').value,
                    date: document.getElementById('date').value,
                    exercises: {}
                };
                
                // Collect exercises data
                const exerciseNames = [
                    'Incline DB Press (ÿØÿßŸÖÿ®ŸÑ ÿπÿßŸÑŸä ŸÑŸÑÿµÿØÿ±)',
                    'Tricep Pushdown (ÿ™ÿ±ÿßŸä ÿ®Ÿàÿ¥ ÿØÿßŸàŸÜ)',
                    'Wide Lat Pull Down (ÿ≥ÿ≠ÿ® ÿπÿßŸÑŸä Ÿàÿßÿ≥ÿπ)',
                    'T-Bar Row (ÿ≥ÿ≠ÿ® ÿπÿßŸÑÿ™Ÿä ÿ®ÿßÿ±)'
                ];
                
                for (let i = 1; i <= 4; i++) {
                    const numSets = parseInt(document.getElementById(`exercise${i}_sets`).value) || 0;
                    const sets = [];
                    
                    for (let j = 1; j <= numSets; j++) {
                        const reps = document.getElementById(`exercise${i}_set${j}_reps`)?.value || '';
                        const weight = document.getElementById(`exercise${i}_set${j}_weight`)?.value || '';
                        sets.push({
                            set: j,
                            reps: reps,
                            weight: weight
                        });
                    }
                    
                    formData.exercises[`exercise${i}`] = {
                        name: exerciseNames[i - 1],
                        numSets: numSets,
                        sets: sets
                    };
                }
                
                // Attachment info
                const attachment = document.getElementById('attachment').files[0];
                if (attachment) {
                    formData.attachment = {
                        name: attachment.name,
                        size: formatFileSize(attachment.size),
                        type: attachment.type
                    };
                }
                
                // Display in console
                console.log('üìß Form Data:', formData);
                
                // Create email preview
                let emailPreview = `
Daily Workout Tracking Form

Personal Information:
- Name: ${formData.name}
- Email: ${formData.email}
- Weight: ${formData.weight} kg
- Date: ${formData.date}

Exercises:
`;
                
                for (let i = 1; i <= 4; i++) {
                    const exercise = formData.exercises[`exercise${i}`];
                    emailPreview += `\n${i}. ${exercise.name}:\n`;
                    emailPreview += `   - Number of Sets: ${exercise.numSets}\n`;
                    exercise.sets.forEach(set => {
                        emailPreview += `   Set ${set.set}: ${set.reps} reps √ó ${set.weight} kg\n`;
                    });
                }
                
                if (formData.attachment) {
                    emailPreview += `\nAttachment: ${formData.attachment.name} (${formData.attachment.size})`;
                }
                
                console.log('üìÑ Email Preview:', emailPreview);
                
                // Show success message
                messageDiv.className = 'message success';
                messageDiv.textContent = '‚úÖ Form submitted successfully! Check Console (F12) to see the data.';
                messageDiv.style.display = 'block';
                
                // Show alert
                alert('‚úÖ Form submitted successfully!\n\nOpen Console (Press F12) to see the complete data.\n\n' + 
                      'Name: ' + formData.name + '\n' +
                      'Email: ' + formData.email + '\n' +
                      'Weight: ' + formData.weight + ' kg');
                
                // Reset form after delay
                setTimeout(() => {
                    document.getElementById('workoutForm').reset();
                    document.getElementById('date').valueAsDate = new Date();
                    fileUploadContent.style.display = 'flex';
                    filePreview.style.display = 'none';
                    previewImage.src = '';
                    previewImage.style.display = 'none';
                    
                    // Clear sets containers
                    for (let i = 1; i <= 4; i++) {
                        document.getElementById(`exercise${i}_sets_container`).innerHTML = '';
                    }
                }, 2000);
                
            } catch (error) {
                console.error('Error:', error);
                messageDiv.className = 'message error';
                messageDiv.textContent = '‚ùå Error: ' + error.message;
                messageDiv.style.display = 'block';
            } finally {
                // Re-enable submit button
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit (Test Mode)';
            }
        });
    </script>
</body>
</html>
